# Docker Compose for Intention Test Backend
# Usage:
#   OPENAI_API_KEY=sk-xxx docker-compose up -d
#   docker-compose logs -f backend
#   docker-compose down

services:
  backend:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: intention-test-backend
    ports:
      - "8080:8080"
    environment:
      - OPENAI_API_KEY=${OPENAI_API_KEY:-}
      - OPENAI_API_URL=${OPENAI_API_URL:-https://api.chatanywhere.tech/v1}
      - SERVER_PORT=8080
    volumes:
      # Mount config.ini if you prefer file-based configuration
      - ./backend/config.ini:/app/backend/config.ini:ro
    restart: unless-stopped
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8080/"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 60s
